<h2 mat-dialog-title>System Logs</h2>
<mat-dialog-content class="logs-container">
    <mat-form-field appearance="fill" style="width: 100%; margin-bottom: 16px;">
        <mat-label>Select Node</mat-label>
        <mat-select [(ngModel)]="selectedNode" (selectionChange)="refresh()">
            <mat-option *ngFor="let node of nodes" [value]="node.node">
                {{node.node}} <span *ngIf="node.me">(Me)</span>
            </mat-option>
        </mat-select>
    </mat-form-field>

    <mat-tab-group>
        <mat-tab label="Execution Logs">
            <table mat-table [dataSource]="executionLogs" class="mat-elevation-z2">
                <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef> ID </th>
                    <td mat-cell *matCellDef="let log"> {{log.id}} </td>
                </ng-container>
                <ng-container matColumnDef="timestamp">
                    <th mat-header-cell *matHeaderCellDef> Time </th>
                    <td mat-cell *matCellDef="let log">{{ log.timestamp | date:'yyyy-MM-dd HH:mm:ss' }} </td>
                </ng-container>
                <ng-container matColumnDef="cmd">
                    <th mat-header-cell *matHeaderCellDef> Command </th>
                    <td mat-cell *matCellDef="let log"> {{log.cmd}} </td>
                </ng-container>
                <ng-container matColumnDef="args">
                    <th mat-header-cell *matHeaderCellDef> Args </th>
                    <td mat-cell *matCellDef="let log"> {{log.args | json}} </td>
                </ng-container>
                <ng-container matColumnDef="execution_time">
                    <th mat-header-cell *matHeaderCellDef> Exec Time (ms) </th>
                    <td mat-cell *matCellDef="let log"> {{log.execution_time}} </td>
                </ng-container>
                <ng-container matColumnDef="result">
                    <th mat-header-cell *matHeaderCellDef> Result </th>
                    <td mat-cell *matCellDef="let log"> {{log.code}} </td>
                </ng-container>
                <ng-container matColumnDef="description">
                    <th mat-header-cell *matHeaderCellDef> Description </th>
                    <td mat-cell *matCellDef="let log"> {{log.description}} </td>
                </ng-container>
                
                <tr mat-header-row *matHeaderRowDef="executionColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: executionColumns;"></tr>
            </table>
        </mat-tab>

        <mat-tab label="Communication Logs">
            <table mat-table [dataSource]="communicationLogs" class="mat-elevation-z2">
                <ng-container matColumnDef="id">
                    <th mat-header-cell *matHeaderCellDef> ID </th>
                    <td mat-cell *matCellDef="let log"> {{log.id}} </td>
                </ng-container>
                <ng-container matColumnDef="timestamp">
                    <th mat-header-cell *matHeaderCellDef> Time </th>
                    <td mat-cell *matCellDef="let log"> {{log.timestamp | date:'yyyy-MM-dd HH:mm:ss'}} </td>
                </ng-container>
                <ng-container matColumnDef="type">
                    <th mat-header-cell *matHeaderCellDef> Type </th>
                    <td mat-cell *matCellDef="let log"> {{log.incoming ? 'IN' : 'OUT'}} </td>
                </ng-container>
                <ng-container matColumnDef="request">
                    <th mat-header-cell *matHeaderCellDef> Request </th>
                    <td mat-cell *matCellDef="let log"> {{log.request}} </td>
                </ng-container>
                <ng-container matColumnDef="response">
                    <th mat-header-cell *matHeaderCellDef> Response </th>
                    <td mat-cell *matCellDef="let log"> {{log.response}} </td>
                </ng-container>
                
                <tr mat-header-row *matHeaderRowDef="communicationColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: communicationColumns;"></tr>
            </table>
        </mat-tab>
    </mat-tab-group>
</mat-dialog-content>
<mat-dialog-actions align="end">
  <button mat-button mat-dialog-close>Close</button>
  <button mat-button color="primary" (click)="refresh()">Refresh</button>
</mat-dialog-actions>
